{"version":3,"file":"dtls.js","sourceRoot":"","sources":["../../../../../dtls/src/context/dtls.ts"],"names":[],"mappings":";;;AAMA,MAAa,WAAW;IAqBtB,YAAmB,OAAgB,EAAS,WAAyB;QAAlD,YAAO,GAAP,OAAO,CAAS;QAAS,gBAAW,GAAX,WAAW,CAAc;QApBrE,YAAO,GAAG,EAAE,KAAK,EAAE,GAAG,GAAG,CAAC,EAAE,KAAK,EAAE,GAAG,GAAG,CAAC,EAAE,CAAC;QAC7C,eAAU,GAAgB,EAAE,CAAC;QAC7B,gBAAW,GAAa,EAAE,CAAC;QAC3B,yBAAoB,GAAG,CAAC,CAAC;QACzB,mBAAc,GAAG,CAAC,CAAC;QACnB,UAAK,GAAG,CAAC,CAAC;QACV,WAAM,GAAG,CAAC,CAAC;QACX,mBAAc,GAIR,EAAE,CAAC;QAET,8BAAyB,GAAa,EAAE,CAAC;QACzC,iCAA4B,GAGtB,EAAE,CAAC;QACT,+BAA0B,GAAG,KAAK,CAAC;IAEqC,CAAC;IAEzE,oBAAoB,CAClB,UAAiC,EACjC,OAAgB,EAChB,MAAc;QAEd,IAAI,CAAC,cAAc,GAAG;YACpB,GAAG,IAAI,CAAC,cAAc;YACtB,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;gBAC3B,OAAO;gBACP,IAAI;gBACJ,MAAM;aACP,CAAC,CAAC;SACJ,CAAC;IACJ,CAAC;CACF;AArCD,kCAqCC","sourcesContent":["import { HashAlgorithms, SignatureAlgorithms } from \"../cipher/const\";\nimport { SessionTypes } from \"../cipher/suites/abstract\";\nimport { FragmentedHandshake } from \"../record/message/fragment\";\nimport { Options } from \"../socket\";\nimport { Handshake } from \"../typings/domain\";\n\nexport class DtlsContext {\n  version = { major: 255 - 1, minor: 255 - 2 };\n  lastFlight: Handshake[] = [];\n  lastMessage: Buffer[] = [];\n  recordSequenceNumber = 0;\n  sequenceNumber = 0;\n  epoch = 0;\n  flight = 0;\n  handshakeCache: {\n    isLocal: boolean;\n    data: FragmentedHandshake;\n    flight: number;\n  }[] = [];\n  cookie?: Buffer;\n  requestedCertificateTypes: number[] = [];\n  requestedSignatureAlgorithms: {\n    hash: HashAlgorithms;\n    signature: SignatureAlgorithms;\n  }[] = [];\n  remoteExtendedMasterSecret = false;\n\n  constructor(public options: Options, public sessionType: SessionTypes) {}\n\n  bufferHandshakeCache(\n    handshakes: FragmentedHandshake[],\n    isLocal: boolean,\n    flight: number\n  ) {\n    this.handshakeCache = [\n      ...this.handshakeCache,\n      ...handshakes.map((data) => ({\n        isLocal,\n        data,\n        flight,\n      })),\n    ];\n  }\n}\n"]}